<div class="comment-item" [style.margin-left.px]="depth() * 24">
  @if (depth() > 0) {
    <div class="comment-thread-line"></div>
  }

  <div class="comment-content">
    <div class="comment-header">
      <app-user-avatar
        [username]="comment().authorUsername"
        [imageUrl]="comment().authorAvatar ?? ''"
        [size]="24"
      ></app-user-avatar>
      <a [routerLink]="['/profile', comment().authorUsername]" class="comment-author">
        {{ comment().authorUsername }}
      </a>
      @if (comment().isOp) {
        <span class="op-badge">OP</span>
      }
      <span class="comment-time">{{ formatTime(comment().createdAt) }}</span>
    </div>

    <div class="comment-body">
      {{ comment().content }}
    </div>

    <div class="comment-footer">
      <app-vote-buttons
        [upvotes]="comment().upvotes"
        [downvotes]="comment().downvotes"
        [userVote]="comment().userVote"
        [orientation]="'horizontal'"
        (vote)="onVoteClick($event)"
      ></app-vote-buttons>

      <button class="comment-action" (click)="toggleReply()">
        <span class="material-icons">reply</span>
        <span>Reply</span>
      </button>

      @if (canModerate()) {
        <button class="comment-action" (click)="deleteComment()">
          <span class="material-icons">delete</span>
          <span>Delete</span>
        </button>
      }

      <!-- âœ… REMOVED: Report button -->
    </div>

    @if (showReplyForm()) {
      <div class="reply-form-container">
        <app-comment-form
          [isReplying]="true"
          (submit)="submitReply($event)"
          (cancelReply)="toggleReply()"
        ></app-comment-form>
      </div>
    }

    @if (comment().replies.length > 0) {
      <div class="comment-replies">
        @for (reply of comment().replies; track reply.id) {
          <app-comment-item
            [comment]="reply"
            [depth]="depth() + 1"
            (reply)="onNestedReply($event)"
            (vote)="onNestedVote($event)"
            (delete)="onNestedDelete($event)"
          ></app-comment-item>
        }
      </div>
    }
  </div>
</div>